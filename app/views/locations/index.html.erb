<!-- Google map library files -->
<%= javascript_include_tag "http://maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" %>
<%= javascript_include_tag "http://google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js" %>

<!-- Google map div -->
<div style='width: 800px;'>
  <div id="feed_map" style='width: 1200px; height: 600px;'></div>
</div>
    


<script>
// method to call to create map
// var directionsDisplay = new google.maps.DirectionsRenderer();
// var directionsService = new google.maps.DirectionsService();
// function calcRoute() {
//   var origin      = new google.maps.LatLng(43, 3.5);
//   var destination = new google.maps.LatLng(51, 3.5);
//   var request = {
//       origin:      origin,
//       destination: destination,
//       travelMode:  google.maps.TravelMode.DRIVING
//   };
//   directionsService.route(request, function(response, status) {
//     if (status == google.maps.DirectionsStatus.OK) {
//       directionsDisplay.setDirections(response);
//     }
//   });
// }

//calcRoute();

function initialize(){
		
	  var handler = Gmaps.build('Google');
	  handler.buildMap({ provider: {}, internal: {id: 'feed_map'}}, function(){
	  markers = handler.addMarkers(<%=raw @hash.to_json %>);

	  handler.bounds.extendWith(markers);
	  handler.fitMapToBounds();
	});
	
	// var handler = Gmaps.build('Google');
// 	handler.buildMap({ internal: {id: 'feed_map'}}, function(){
// 	  var markers = handler.addMarkers([
// 	    { lat: 43, lng: 3.5},
// 	    { lat: 45, lng: 4},
// 	    { lat: 47, lng: 3.5},
// 	    { lat: 49, lng: 4},
// 	    { lat: 51, lng: 3.5}
// 	  ]);
// 	  handler.bounds.extendWith(markers);
// 	  handler.fitMapToBounds();
// 	  directionsDisplay.setMap(handler.getMap());
// 	});
}

google.maps.event.addDomListener(window, "load", initialize);

</script>